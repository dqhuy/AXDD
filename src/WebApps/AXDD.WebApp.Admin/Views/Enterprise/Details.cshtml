@model AXDD.WebApp.Admin.Models.ViewModels.EnterpriseDetailsViewModel
@{
    ViewData["Title"] = "Enterprise Details";
}

@section Breadcrumb {
    <li class="breadcrumb-item"><a asp-controller="Home" asp-action="Index">Home</a></li>
    <li class="breadcrumb-item"><a asp-controller="Enterprise" asp-action="Index">Enterprises</a></li>
    <li class="breadcrumb-item active">Details</li>
}

<div class="row">
    <div class="col-md-12">
        <!-- Enterprise Info Card -->
        <div class="card card-primary card-outline">
            <div class="card-header">
                <h3 class="card-title">
                    <i class="fas fa-building mr-2"></i>
                    @Model.Name
                </h3>
                <div class="card-tools">
                    @{
                        var statusClass = Model.Status switch
                        {
                            "Active" => "badge-success",
                            "Inactive" => "badge-secondary",
                            "Suspended" => "badge-danger",
                            _ => "badge-secondary"
                        };
                    }
                    <span class="badge @statusClass">@Model.Status</span>
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <dl class="row">
                            <dt class="col-sm-4">Tax Code:</dt>
                            <dd class="col-sm-8">@Model.TaxCode</dd>

                            <dt class="col-sm-4">Enterprise Type:</dt>
                            <dd class="col-sm-8">
                                <span class="badge badge-info">@Model.EnterpriseType</span>
                            </dd>

                            <dt class="col-sm-4">Legal Representative:</dt>
                            <dd class="col-sm-8">@(Model.LegalRepresentative ?? "N/A")</dd>

                            <dt class="col-sm-4">Phone:</dt>
                            <dd class="col-sm-8">
                                @if (!string.IsNullOrEmpty(Model.Phone))
                                {
                                    <a href="tel:@Model.Phone">
                                        <i class="fas fa-phone"></i> @Model.Phone
                                    </a>
                                }
                                else
                                {
                                    <text>N/A</text>
                                }
                            </dd>

                            <dt class="col-sm-4">Email:</dt>
                            <dd class="col-sm-8">
                                @if (!string.IsNullOrEmpty(Model.Email))
                                {
                                    <a href="mailto:@Model.Email">
                                        <i class="fas fa-envelope"></i> @Model.Email
                                    </a>
                                }
                                else
                                {
                                    <text>N/A</text>
                                }
                            </dd>
                        </dl>
                    </div>
                    <div class="col-md-6">
                        <dl class="row">
                            <dt class="col-sm-4">Website:</dt>
                            <dd class="col-sm-8">
                                @if (!string.IsNullOrEmpty(Model.Website))
                                {
                                    <a href="@Model.Website" target="_blank" rel="noopener noreferrer">
                                        <i class="fas fa-external-link-alt"></i> @Model.Website
                                    </a>
                                }
                                else
                                {
                                    <text>N/A</text>
                                }
                            </dd>

                            <dt class="col-sm-4">Address:</dt>
                            <dd class="col-sm-8">@(Model.Address ?? "N/A")</dd>

                            <dt class="col-sm-4">Industrial Zone:</dt>
                            <dd class="col-sm-8">@(Model.IndustrialZone ?? "N/A")</dd>

                            <dt class="col-sm-4">Created:</dt>
                            <dd class="col-sm-8">
                                <i class="fas fa-calendar"></i> @Model.CreatedAt.ToString("MMM dd, yyyy HH:mm")
                            </dd>

                            <dt class="col-sm-4">Last Updated:</dt>
                            <dd class="col-sm-8">
                                @if (Model.UpdatedAt.HasValue)
                                {
                                    <i class="fas fa-calendar-check"></i>
                                    @Model.UpdatedAt.Value.ToString("MMM dd, yyyy HH:mm")
                                }
                                else
                                {
                                    <text>N/A</text>
                                }
                            </dd>
                        </dl>
                    </div>
                </div>
            </div>
            <div class="card-footer">
                <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-warning">
                    <i class="fas fa-edit"></i> Edit
                </a>
                <button type="button" class="btn btn-danger" onclick="confirmDelete('@Model.Id', '@Model.Name')">
                    <i class="fas fa-trash"></i> Delete
                </button>
                <a asp-action="Index" class="btn btn-secondary">
                    <i class="fas fa-list"></i> Back to List
                </a>
            </div>
        </div>

        <!-- Statistics Cards -->
        <div class="row">
            <div class="col-md-6">
                <div class="small-box bg-info">
                    <div class="inner">
                        <h3>@Model.TotalDocuments</h3>
                        <p>Total Documents</p>
                    </div>
                    <div class="icon">
                        <i class="fas fa-folder"></i>
                    </div>
                    <a asp-controller="Document" asp-action="Index" asp-route-enterpriseId="@Model.Id" class="small-box-footer">
                        View Documents <i class="fas fa-arrow-circle-right"></i>
                    </a>
                </div>
            </div>

            <div class="col-md-6">
                <div class="small-box bg-success">
                    <div class="inner">
                        <h3>@Model.TotalReports</h3>
                        <p>Total Reports</p>
                    </div>
                    <div class="icon">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <a asp-controller="Report" asp-action="Index" asp-route-enterpriseId="@Model.Id" class="small-box-footer">
                        View Reports <i class="fas fa-arrow-circle-right"></i>
                    </a>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="card card-primary card-tabs">
            <div class="card-header p-0 pt-1">
                <ul class="nav nav-tabs" id="enterprise-tabs" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" id="info-tab" data-toggle="pill" href="#info" role="tab" aria-controls="info" aria-selected="true">
                            <i class="fas fa-info-circle"></i> Information
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="documents-tab" data-toggle="pill" href="#documents" role="tab" aria-controls="documents" aria-selected="false">
                            <i class="fas fa-folder"></i> Documents
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="reports-tab" data-toggle="pill" href="#reports" role="tab" aria-controls="reports" aria-selected="false">
                            <i class="fas fa-file-alt"></i> Reports
                        </a>
                    </li>
                </ul>
            </div>
            <div class="card-body">
                <div class="tab-content" id="enterprise-tabContent">
                    <!-- Info Tab -->
                    <div class="tab-pane fade show active" id="info" role="tabpanel" aria-labelledby="info-tab">
                        <h5>Enterprise Information</h5>
                        <p>All the essential information about this enterprise is displayed above. Use the Edit button to update any details.</p>
                        
                        <div class="alert alert-info">
                            <h5><i class="icon fas fa-info"></i> Quick Stats</h5>
                            <ul class="mb-0">
                                <li>Total Documents: <strong>@Model.TotalDocuments</strong></li>
                                <li>Total Reports: <strong>@Model.TotalReports</strong></li>
                                <li>Status: <strong>@Model.Status</strong></li>
                                <li>Type: <strong>@Model.EnterpriseType</strong></li>
                            </ul>
                        </div>
                    </div>

                    <!-- Documents Tab -->
                    <div class="tab-pane fade" id="documents" role="tabpanel" aria-labelledby="documents-tab">
                        <h5>Documents</h5>
                        <p>View and manage documents associated with this enterprise.</p>
                        
                        <div class="text-center py-4">
                            <i class="fas fa-folder-open fa-3x text-muted mb-3"></i>
                            <p class="text-muted">@Model.TotalDocuments document(s) found</p>
                            <a asp-controller="Document" asp-action="Index" asp-route-enterpriseId="@Model.Id" class="btn btn-primary">
                                <i class="fas fa-eye"></i> View All Documents
                            </a>
                            <a asp-controller="Document" asp-action="Upload" asp-route-enterpriseId="@Model.Id" class="btn btn-success">
                                <i class="fas fa-upload"></i> Upload Document
                            </a>
                        </div>
                    </div>

                    <!-- Reports Tab -->
                    <div class="tab-pane fade" id="reports" role="tabpanel" aria-labelledby="reports-tab">
                        <h5>Reports</h5>
                        <p>View and manage reports submitted by this enterprise.</p>
                        
                        <div class="text-center py-4">
                            <i class="fas fa-file-alt fa-3x text-muted mb-3"></i>
                            <p class="text-muted">@Model.TotalReports report(s) found</p>
                            <a asp-controller="Report" asp-action="Index" asp-route-enterpriseId="@Model.Id" class="btn btn-primary">
                                <i class="fas fa-eye"></i> View All Reports
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header bg-danger">
                <h5 class="modal-title" id="deleteModalLabel">
                    <i class="fas fa-exclamation-triangle"></i> Confirm Delete
                </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete the enterprise <strong id="enterpriseName"></strong>?</p>
                <p class="text-danger">This action cannot be undone and will also delete all associated documents and reports.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <form id="deleteForm" method="post" style="display: inline;">
                    @Html.AntiForgeryToken()
                    <button type="submit" class="btn btn-danger">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        function confirmDelete(id, name) {
            $('#enterpriseName').text(name);
            $('#deleteForm').attr('action', '/Enterprise/Delete/' + id);
            $('#deleteModal').modal('show');
        }
    </script>
}
